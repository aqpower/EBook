import{d as C,k as o,l as I,f as m,g as e,w as p,m as g,n as x,h as V,i as U,_ as A,F as z,p as D,t as L,a as Z,j as v}from"./index-09020506.js";import{U as j}from"./user-1668f9ec.js";const B=e("h2",{class:"text-base-content mt-1 text-center text-2xl font-bold leading-9 tracking-tight"}," 登录你的账户 ",-1),N={class:"mt-10 sm:mx-auto sm:w-full sm:max-w-sm"},R={class:"space-y-6"},S=e("div",{class:"flex items-center justify-between"},[e("label",{for:"email",class:"block text-sm font-medium leading-6 text-base-content"},"账户"),e("div",{class:"text-sm"},[e("a",{href:"#/account/adminLogin",class:"font-semibold text-rose-400 hover:text-rose-300"},"管理员登录")])],-1),T={class:"mt-2"},F=e("div",{class:"flex items-center justify-between"},[e("label",{for:"password",class:"block text-sm font-medium leading-6 text-base-content"},"密码"),e("div",{class:"text-sm"},[e("a",{href:"#/account/resetPassword",class:"font-semibold text-rose-400 hover:text-rose-300"},"忘记密码?")])],-1),$={class:"mt-2"},E={key:0,class:"loading loading-bars loading-xs h-6"},P={key:1,class:"h-6"},H=e("p",{class:"mt-3 text-base-content text-center text-sm"},[D(" 还没有账户🤔 "+L(" ")+" "),e("a",{href:"#/account/register",class:"font-semibold leading-6 text-rose-400 hover:text-rose-300 hover:cursor-pointer"},"点击注册！")],-1),G=C({__name:"LoginCard",setup(M){const l=o(""),r=o(""),n=o(!1),i=o(!1),d=o(""),c=o(""),h=o("👌");let f=()=>{n.value=!1};const b=I();function _(){const u=/^(?=.*[A-Za-z\d])[A-Za-z\d]{6,}$/,s=/^[A-Za-z0-9._-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,}$/,t=l.value.length===8||s.test(l.value),a=u.test(r.value);if(!t&&!a)return{valid:!1,msg:"账户必须是8个字符长的ID或有效的邮箱。密码位数至少为6位字符，且仅含数字字符或字母字符。"};if(t){if(!a)return{valid:!1,msg:"密码位数至少为6位字符，且仅含数字字符或字母字符。"}}else return{valid:!1,msg:"账户必须是8个字符长的ID或有效的邮箱。"};return{valid:!0,msg:"验证成功"}}const w=()=>{n.value=!0;const u=_();if(!u.valid)d.value="🙁",c.value=u.msg,i.value=!0;else{let s={password:r.value};l.value.includes("@")?s.email=l.value:s.id=l.value,j(s).then(t=>{console.log(t);const a=t.data;if(t.msg=="success"){d.value="😊",c.value="登录成功",i.value=!0;const y=Z(),k={id:a.id,name:a.name,email:a.email,token:a.token,avatar:a.avatar};y.setUser(k),f=()=>{b.push("/home/explore")}}else d.value="😥",c.value=t.msg,i.value=!0}).finally(()=>{setTimeout(()=>{n.value=!1},3e3)})}};return(u,s)=>(v(),m(z,null,[B,e("div",N,[e("div",R,[e("div",null,[S,e("div",T,[p(e("input",{id:"email","onUpdate:modelValue":s[0]||(s[0]=t=>l.value=t),autocomplete:"off",placeholder:"请输入邮箱或用户ID",class:"input input-bordered input-primary w-full sm:text-sm sm:leading-5 h-10"},null,512),[[g,l.value]])])]),e("div",null,[F,e("div",$,[p(e("input",{"onUpdate:modelValue":s[1]||(s[1]=t=>r.value=t),id:"password",type:"password",placeholder:"请输入密码",class:"input input-bordered input-primary w-full sm:text-sm sm:leading-5 h-10"},null,512),[[g,r.value]])])]),e("div",null,[e("button",{class:"min-h-0 h-9 btn btn-primary flex w-full justify-center rounded-md px-3 py-1.5 leading-6 shadow-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",onClick:w},[n.value?(v(),m("span",E)):x("",!0),n.value?x("",!0):(v(),m("span",P,"登录"))])])]),H]),V(A,{visible:i.value,title:d.value,content:c.value,"onUpdate:visible":s[2]||(s[2]=t=>i.value=t),btnContent:h.value,onClose:U(f)},null,8,["visible","title","content","btnContent","onClose"])],64))}});export{G as default};
